-*- mode:org -*-
#+TAGS: work
#+TYP_TODO: TODO(t) WAIT(w) | DONE(d)
#+STARTUP: latexpreview
#+TITLE: Research Notes/TODOs
* capture 
** DONES
*** DONE [#A] Solve for Tej (ej?) if Tek = infty algebraic/numerical
*** DONE [#A] Test different tolerance settings & integrators for ecc decay
- plot avg(sin(theta)) for diff tol/integrators to see if numerical issue
*** DONE [#A] Integrate a reasonable time for orbit evolution of q=0.001 for ecc decay
*** DONE solve analytical eq for e1/2d driving eccs
*** DONE Test different Te1/Te2 ratios for ecc decay
*** DONE read petigura 2019
*** DONE read ragusa 2018
*** DONE [#A] write up new Dpomega varyTe section
*** DONE [#A] run longer integration for $Te1/Te2=0.1$
*** DONE [#A] write why Dpomeg to 0
*** DONE [#B] comment about setting $Tw0=10$ kyr
*** DONE [#A] comment on loose terminology
*** DONE [#A] Change e1, e2 calc in [[file:~/multi-planet-architecture/run.py]] to proper delaunay variables
*** DONE [#A] comparable mass Hamiltonian [3/3]
**** DONE make git commit w/ test particle test suite
**** DONE clean up, organize files
**** DONE write & test comparable mass H code
* Meetings
** [2021-08-27 Fri] MEETING
1. fix equation 4
2. discuss plus/minus migrations, define 1/Tm = diff
3. fig 4 why not symmetric? put q inside fix y labels
4. fix figure 5 theta hat
** [2021-08-20 Fri] MEETING
1. label all equations
2. Hhat to end
3. Include system parameters in captions
4. Fig 2 at beginning of 2.2
   - example/answer -> then explain
5. check error bars if so then show example of large e variations
6. add analytic estimate to figure 5
7. erase w/o secular line in Figure 5
8. Figure 6 plot Delta pomega -180 to 180, not absolute value
9. Fewer dots/integrations for figures 4 and 5
** [2021-08-12 Thu] MEETING

** [2021-08-06 Fri] MEETING
1. Mention K2-19 in intro/sec2
2. Integrate sec4 into sec3; it's not useful to fit the system exactly
3. seems like we reach a different equilibrium depending on initial
   conditions
4. ecc driving ansatz -> robust alignment
5. possibly high initial eccentricities ? less robust? another channel?
6. Make analytical argument with the first 2 equilibrium equations
   for the plot:
   - |$\Delta\varpi$
     |
     |________________
     0.2  1  5 Te1/Te2       
** [2021-07-30 Fri] MEETING
1. First do natural Te e/Te e->0
2. Section 2 standard picture
3. 1st thing show secular coupling, 1 example
4. section 2 like a recap, review, show why $\Delta\varpi\to\pi$, with
   small correction as a function of (q, Tw0)
5. make a detailed outline 
6. section 3 consider toy model e1d>0, same parameters
*** Dong's outline sketch
1. Introduction
2. Recap of "standard" picture
   - forces: e1/Te1, e2/Te2
   - cases
     q=2
     q=1
     q=1/2
   - |e1eq, e2eq
     |
     |________________
     0.2  1  5 Te1/Te2       
   - |$\Delta\varpi$
     |
     |________________
     0.2  1  5 Te1/Te2       
3. Toy Model, e1d>0
   - forces: (e1-e1d)/Te1, e2/Te2
   - cases
     q=2
     q=1
     q=1/2
   - |e1eq, e2eq
     |
     |________________
     0.2  1  5 Te1/Te2       
   - |$\Delta\varpi$
     |
     |________________
     0.2  1  5 Te1/Te2
4. "Fancy" Hamiltonian
** [2021-07-23 Fri] MEETING
1. try q ~ 1 for T >> Te2 to see if equilibrium is reached
2. try runs with the "story" of the capture process:
   - for alignment must have e_20 > mu_1^2/3 and e_10 > mu_2^2/3 to
     avoid capture into theta1/2 resonances
   - must have hat(e) within resonance capture range for hat(theta)
   - damping stops before theta1/2 equilibrium is reached
*** Plans for draft of paper
1. Introduction
   - K2-19 is puzzling in light of anti-alignment outcome
2. Summarize q first
   - example, stable case T to infty
   - secular term modification "canonical case"
   - why anti-alignment, small secular effects
3. TP case (possibly sec1 or in appendix if not relevant)
*** Plans for research talk
- K2-19 system
- Subresonances
- reproducing TP results with q=1000
  - analytic equilibrium results, not a true equilibrium
- Driving eccentricities for q~O(1) cases
  - reproducing K2-19 alignment
  - disucssion of Tei physics?
** [2021-07-16 Fri] MEETING
1. Solve for Tej if Tek = infty algebraic/numerical
2. Only drive the larger planet's eccentricity to be nonzero
3. Look at observations of $\Delta\varpi$. How do they measure it?
   1. are there any observed aligned cases in the literature?
   2. If so, this is counter to the strong conclusion that the
      resonance is resilient to the the Te1/Te2 ratio and that in
      resonance the planets are always anti-aligned. *This could be the
      argument for your paper.*
4. Try comparable mass for e2d->0.1, maybe q=2
5. Ragusa 2018 eccentricity evolution during planet disk interaction
   1. Long hydro simulation
6. *Problem of why q=1000 affects teh larger planet so much!!!!*
   1. *Integrate a reasonable time for orbit evolution of q=0.001*
   2. Compare Te1/Te2 reasonable case to crazy large case
   3. Compare Te2 timescale to theta2 resonance timescale. Is it
      constant on a reasonable timescale of integration?
   4. Run for only a few Te of the smaller planet
   5. Try BS integrator & vary tolerance while plotting
      avg(sin(theta)) to see if results agree and it's not the code's
      fault
** [2021-07-09 Fri] MEETING
1. It seems like the secular terms don't matter that much for the
   q~[0.1-1] case for comparable masses
2. For more extreme mass ratios, such as q~[0.001-0.01], dynamics may
   be more interesting
   - in this regime Te2 is an arbitrary /parameter/ because a massive
     planet's eccentricity damping will not be identical to a very
     small neighbor
   - Gap opening planet, sustained eccentricity, negative Te2?
3. If we are writing a paper, what comes next?
   - brief introduction of TP case
   - Parameter study of q~[0,1e-2], Te2 parameter, how this relates to
     apsidal alignment/equilibrium eccentricity
4. Papers mentioned:
   - Chelsea Huang Warm Jupiter Neighbors, Wasp-47 system
5. *Big picture*:
   - What happens to a smaller (<~1%) mass planet when approaching a MMR with a massive planet? 
   - How does this relate to apsidal alignment?
*** Laetitia's equilibrium plots:
[[file:ltximg/Alignment.png]]
[[file:ltximg/Alignment_weakerdamping.png]]
*** DONE [#A] Read Huang paper
*** DONE [#A] Get equilibrium solving code working you idiot
- look at extreme mass ratios
- how do secular terms change the behavior?
*** DONE [#B] Find a good parameter range for q, Te2, etc
*** DONE [#B] test parameter space with time-dependent numerical runs
- in effort to answer #5 above
** [2021-07-02 Fri] MEETING
/I think I am stupid/
1. Redo xu 2018 equations 16-18 but with the secular terms to see
   where equilibrium is, make the same plots
2. Compare numerical results of equilibrium with secular terms turned
   off to see the difference
* Equations pdfs
[[file:~/multi-planet-architecture/docs/4dof-pdf/4dof_diffeqs.pdf]]
** coefficients
#+BEGIN_SRC jupyter-python :session /jpy:localhost#8888:research
  sys.path.append("/home/jtlaune/multi-planet-architecture/")
  from helper import *
  alpha_0 = (j/(j+1))**(2./3.)
  f1 = -A(alpha_0, j)
  f2 = -B(alpha_0, j)
  f3 = C(alpha_0)
  f4 = D(alpha_0)
  print([f"{fi:0.2f}" for fi in [f1, f2, f3, f4]])
#+END_SRC

#+RESULTS:
: ['2.03', '-2.48', '1.15', '-2.00']

* Relevant Observed systems                                          :ATTACH:
** K2-19 b & c; Petigura et al. (2019)
- M_star = 0.88 Msun
- Pb = 7.9222d Pc = 11.8993d
- Mb = 32.4ME Mc = 10.8ME
- mu1 = 1.11e-4 mu2 = 3.69e-5 q = 3.00
- e_b = 0.20 e_c = 0.21
- x_b = sqrt(e_b)*cos(varpi_b) = 0.02
  x_b = sqrt(e_b)*sin(varpi_b) = -0.44
- x_c = sqrt(e_c)*cos(varpi_c) = 0.04
  x_c = sqrt(e_c)*sin(varpi_c) = -0.46
- Dvarpi_bc = 2+-2 deg ~ 0.
** Huang et al. (2016)
[[file:papers/huang-2016-WJneighbors.pdf]]
:PROPERTIES:
:ID:       9ac2be99-7caa-47bf-b897-7babb34634a7
:END:
#+ATTR_ORG: :width 300
[[attachment:2021-07-14_14-34-29_screenshot.png]]
*** Kepler-30 q~0.019, q~26
Panichi et al. (2017)
[[https://arxiv.org/pdf/1707.04962.pdf]]
b,c near 2:1 first order, q~0.019
all transiting
/from exoplanet catalog:/
b 11.3 Me 0.18au 29.3 days e=0.04
c 2.01 Mj 0.3au 60.3 days e=0.01
d 23.1 Me 0.5au 143.3 days e=0.02
*** Wasp-47
b 1.1 Mj
c 1.6 Mj
d 13 Me
e 6.8 Me
*** Kepler-46
b 6 Mj
c 0.38 Mj
d 3.3 Me
*** Kepler-302
b 16 Me
c Unknown WJ
*** Kepler-419
b 2.5 Mj
c 7.3 Mj
*** Kepler-289
b 7.3 Me
c 0.42 Mj
d 4 Me
*** Kepler-418
b 1.1 Mj
*** Kepler-117
b 30 Me
c 1.8 Mj
* validating w/ REBOUND [8/8]
** DONE plot gammadot components to compare
** DONE calculate ring potential
- involves elliptic integral, ```sp.special.ellipkinc'''
- research journal [2021-02-24 Wed] 
** DONE test J_2 external forcing term for perihelion precession rates
[[file:nbody/testsuite/test-omext/mup1.00e-04/om1.00e-03/e0.00e+00.png][file:~/mmr/nbody/testsuite/test-omext/mup1.00e-04/om1.00e-03/e0.00e+00.png]]
** DONE calculate external forcing term in terms of J_2
- research journal [2021-02-11 Thu]
** DONE try to use REBOUNDx to implement om_eff
- reboundx will not install on my system
** DONE investigate REBOUNDx
- implemented lots of extra forces already
- https://reboundx.readthedocs.io/en/latest/effects.html
- going to try to use a negative J_2 value with
#+BEGIN_SRC python
gh = rebx.load_force("gravitational_harmonics")
#+END_SRC python
** DONE check units on om_eff in migforce
- current results show little change in behavior, contradict
  semianalytical
- this cannot be right. I stupidly set the cartesian coordinates of
  the particle equal to the cartesian phase space coordinates:
  #+BEGIN_SOURCE python
if self.omext:
    tpart.ax += -(self.omext**2)*tpart.x
    tpart.ay += -(self.omext**2)*tpart.y
  #+END_SOURCE python
** DONE [#A] compare semianalytical ext-perturber results with REBOUND [2/2]
*** DONE run bottomright test (nonchaotic for edisk = 0.01, ep = 0.1)
finally s ecc excitation, but gammas have contradicting signs and
thetas arculating. i'm thinking its some kind of issue in signs
for om_exuld explain both)
[[file:nbestsuite/collect/precess-eq1.00e-02-ep1.00e-01-om1.00e-03.png][file:~/mmr/nbody/testsuite/collect/precess-eq1.00e-02-ep1.00e-01-om1.00e-03.png]]
[[file:exturber/varyomeff/eq1.00e-02/ep1.00e-01/1.00e-02-1.00e-03.png][file:~/mmr/ext-perturber/varyomeff/eq1.00e-02/ep1.00e-01/1.00e-02-1.00e-03.png]]
*** DONE compare gamma derivatives 
similar behavior, but the first term is circulating for nbody
[[file:ext-perturber/varyomeff/gammadots-eq1.00e-02/ep1.00e-01/4-1.00e-03.png][file:~/mmr/ext-perturber/varyomeff/gammadots-eq1.00e-02/ep1.00e-01/4-1.00e-03.png]]
[[file:nbody/testsuite/collect/precess-gammacomps-eq1.00e-02-ep1.00e-01-om1.00e-03.png][file:~/mmr/nbody/testsuite/collect/precess-gammacomps-eq1.00e-02-ep1.00e-01-om1.00e-03.png]]
* summary
** characteristics
1. chaos (only when om_ext large)
2. internal apsidal alignment
   - om_eff = 0
     * unknown res????<---- figure this out
     * kind of all over the place if im being honest. maybe don't
       include? maybe leave out just migfail runs? not sure what to do
       here
3. external apsidal alignment
   - om_eff = 0
     * gamma -> 0 
     * ep vs edisk grid 
     * EoM analytical analysis
     * plots of gamma-components
       [[file:///home/jtlaune/Dropbox/mmr/external-grid-1e-3/ext-perturber/varyomeff/gammadots-0weff/sum.pdf][summary]]
   - om_eff > 0
     * gamma -> pi
     * heuristic description of EoM
       [[file:/home/jtlaune/Dropbox/mmr/external-grid-1e-3/ext-perturber/varyomeff/sum.pdf][summary]]
     * plot e1 eq numerical value vs om_eff w/ behaviors
     * *figure* gamma component term plots (from above file bottom page 2)
     * gamma component plots
4. equilibrium eccentricity
   - no om_eff ~ disk properties
   - large enough om_eff ~ 1/gammadot from above
* results summary table 

  |--------------+-----------------+---+------------+--------------------+--------------------+--------------------|
  |              | *internal*      |   |            | *external*         |                    |                    |
  |--------------+-----------------+---+------------+--------------------+--------------------+--------------------|
  |              | om_ext = 0      |   | om_ext = 0 | om_ext < res width | om_ext ~ res width | om_ext > res width |
  |--------------+-----------------+---+------------+--------------------+--------------------+--------------------|
  | e_disk < e_p | *disaster zone* |   | *aligned*  |                    |                    |                    |
  |              |                 |   |            |                    |                    |                    |
  |--------------+-----------------+---+------------+--------------------+--------------------+--------------------|
  | e_disk ~ e_p | *aligned*       |   |            |                    |                    | *chaotic*          |
  |              |                 |   |            |                    |                    |                    |
  |              |                 |   |            |                    |                    |                    |
  |--------------+-----------------+---+------------+--------------------+--------------------+--------------------|
  | e_disk > e_p |                 |   |            |                    |                    |                    |
  |              |                 |   |            |                    |                    |                    |
  |              |                 |   |            |                    |                    |                    |
  |--------------+-----------------+---+------------+--------------------+--------------------+--------------------|

** DONE fill in om_ext columns for external
- in paper draft
** DONE think about internal? is it important to include?
yes, should include internal. explain away the bad parts by saying our
model fails

* semianalytical test cases [1/1]
[[file:test-cases.py]]
*** DONE test cases [5/5]
  - [X] inner migrating out, 4 mup stability cases (no cap, cap unstable, cap librate, cap stable)
  - [X] internal equilibrium e
  - [X] outer migrating in, 2 mup capture cases, (no cap, cap)
  - [X] external equilibrium e
  - [X] stability cases w/ ep = 0.01 small
* handwritten research journals
[[file:~/Dropbox/Apps/GoodNotes 5/GoodNotes/multi-planet-architecture/research-notes.pdf::%PDF-1.3][Feb 2020-]]

* Long term objectives
** DONE [#A] list of figures and outline [3/3]
*** DONE apsidal alignment [2/3] 
  - [X] combine internal & external plots
  - [ ] plot heuristic contours from EoM
    - important term is $\cos\theta/e$
    - g-alignment 
      - ep > ed => $\theta\neq\overline{\theta}$ => $\theta$ circ => 1/e term avgs out => $\dot\gamma\to 0$
    - g-circulation
      - ep < ed => $\theta\approx\overline{\theta}$ => $\theta\to 0,\pi$ => 1/e term dominates => $\abs{\dot\gamma}> 0$
  - [X] highlight example runs with red border
*** DONE example runs
  - blurred scatter plots
  - pick 0.01,0.1 and 0.1,0.01
*** DONE phase diagrams
* Waiting on
** WAIT write up comparison of theta1/2 resonant timescales and Te1/2 timescales
** WAIT [#B] phase diagrams [1/3]
- [X] semianalytical
- [ ] n body
- [ ] describe resonance splitting
** WAIT [#B] finish summary [2/4]
- [ ] need to include N-body runs for ext-perturber, non-confirmation or confirmation
- [X] clarify chaotic nature of e1 excitation for omext >~ dn runs
  - ep and edisk similar magnitude => chaotic based on a0
- [X] summary table of runs, cross table, # runs, etc
- [ ] relate eeq to disk properties
** WAIT [#B] test omext in H integrator 
** WAIT [#C] fix & shorten reference-pdf
** WAIT sympy confirmation of sidebyside summary EoMs
** WAIT organize [4/4]
*** DONE org research notes
*** DONE goodnotes research notes
*** DONE meeting notes
*** DONE calculation notes
** WAIT REBOUND
*** WAIT matter ring potential [0/3]
- [ ] implement force in rebound
- [ ] test implementation
- [ ] compare to semianalytical
*** WAIT add interrupt conditions  
** WAIT [#C] fix rebound mmr Tm signs. simplify
** WAIT figure out unknown res situation to be able to include internal runs in summary
