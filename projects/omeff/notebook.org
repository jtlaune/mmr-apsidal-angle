#+TITLE: OmEff Notebook
#+OPTIONS: author:nil date:nil toc:nil
#+LATEX_CLASS: mnras
#+LaTeX_CLASS_OPTIONS: [usenatbib,twocolumn]
* todos                                                            :noexport:
** TODO [#A] "How should I structure my code?"
SCHEDULED: <2022-01-17 Mon> DEADLINE: <2022-01-18 Tue>
*** fndefs.py
- definitions of f1, f2, omega, nu
- replaces helper
*** plotter.py
- unified plotting parameters & size/axis
*** resonance.py
*** run.py
*** runsim -> 'series'-run.py
- calls run.py parallelization library
- 
*** goals [0/3]
- [ ] subsume TP into finite q
- [ ] universally use m1, m2 notation
- [ ] consolidate simulation output to a dict of arrays
** TODO [#A] "how does external precession affect TP capture?"
SCHEDULED: <2022-01-18 Tue> DEADLINE: <2022-01-20 Thu>
** TODO [#B] read and annotate [[file:~/annurev.aa.14.090176.001243.pdf::%PDF-1.4][<peale 1976>]]
** TODO [#B] implement laetitia's changes[[file:~/apsidal-alignment_Laetitiacomments-1.pdf::%PDF-1.5][<no description>]]
*** TODO rename to: Apsidal Alignment in ..
* waits                                                            :noexport:
** TODO get computer account on exo
** TODO *read* papers MMR capture using real hydro
** TODO *read* planet migrating into cavity hydro sims
* dones                                                            :noexport:
** DONE finish setting up following structure:
"run" symlink -> dirname/dirname-run.py
"params" are located dirname/dirname-params.py
** DONE [#A] set up fargo3d 2d "cavity" 
*** derive proper initial conditions to use in [[file:~/fargo3d/setups/cavity/condinit.c::rho\[l\] = SIGMA0*pow(r/R0,-SIGMASLOPE)*(1.0+NOISE*(drand48()-.5));][<no description>]]
commit a95fed6e22aa2c8eef3e8913afd0e9e7b3f61aa4
Author: JT Laune <jtlaune@gmail.com>
Date:   Wed Jan 19 15:10:35 2022 -0500

    Update to cavity running

* Research questions [0/6]                                         :noexport:
** TODO "does the code work?" [1/6]
*** DONE add in support for omeff
*** TODO "does weak precession large q recreate TP equilibrium eccentricities?"
*** TODO run initial tests for omeff code [0/4]
**** TODO migration timescale
**** TODO eccentricity damping timescale
[[file:test-Te.py::TE1 = Tw0/TeRatios][<test-Te>]]
- low muext, check q>>1 with e0=0.1 to check damping timescale
**** TODO omega effective for mu1 << mu2
**** TODO omega effective for mu2 << mu1
[[file:~/Dropbox/multi-planet-architecture/run.py][file:~/Dropbox/multi-planet-architecture/run.py]]
*** TODO debugging code [1/2]
**** DONE try q<1
- nothing
**** TODO try -omeff [0/1]
code only worked for small omeff, i.e. kept crashing, nans
- in definition of omeff, flipped omeff=om2-om2 to omeff=om1-om2
- new behavior: code equilibrates into resonance for small omeff
  - [[file:q2.0/h-0.03-Tw0-1000-mutot-1.0e-03/omeff--1.6e-07-e1d-0.000-e2d-0.000.png]]
  - raise omeff: code equilibrates into some resonances
    - [[file:q2.0/h-0.03-Tw0-1000-mutot-1.0e-03/omeff--4.6e-07-e1d-0.000-e2d-0.000.png]]
    - [[file:q2.0/h-0.03-Tw0-1000-mutot-1.0e-03/omeff--5.4e-07-e1d-0.000-e2d-0.000.png]]
    - various behaviors/timescales to escape resonance. these runs begin
      /in/ resonance, at period ratio = 1.5
- this should explain why the code only started to work with very low
  "negative" omeff frequencies
***** TODO [#A] check math

*** TODO "does finite q precession converge to test particle results?"
*** TODO "what does 1000>q>>1 capture look like?"
** future questions
*** TODO "why does external precession break thetai bar?"
*** TODO "can precession completely disrupt a capture?"
*** TODO "does precession affect equilibrium eccentricities?"
* Commit notes                                                     :noexport:
** v2.4 934682 Update code to use symlinked run directories

Update to "runsim symlink" run directory structure.

For automatic documentation/SSOT design.  Each run directory is now
self contained in a directory named "series", where we have defined
series="whatever descriptive word that we would like to name our
figures after". No longer copy pasting the first 100 lines of code
from a "test-*.py" into plotting applications.  This will be standard
going forward, but "apsidal-alignment" project will remain backwards
compatible because this update simply splits the original test-*.py
files into two files and hooks them together in the following way:

../project/*symlinked-runfile-dir*/
	series-run.py
	series-params.py

../project/
	runsim -> series/series-run.py

Then, executing "python runsim" in ../project/ directory will
check if ../project/series/ exists, and, if not, it will
create it. Next, it enters that directory and begins executing
simulations. All of this happens irrespective of the value
of *symlinked-runfile-dir*, so that the naming scheme
"series-run.py" and "series-params.py" automatically
create output in a directory named "../project/series/".

*Note:* could just have chdired and "python series-run.py",
but it's helpful to manually change the symlink when
switching contexts.
** "both planets can be captured for small omeff over long enough times"

muext=1e-3
mutot=1e-3
aext=15
e1d=e2d=0
==> m2 is captured into theta1 and m1<->theta2

muext=1e-3
mutot=1e-3
aext=10
e1d=e2d=0
==> m2 is *not* captured into theta1 *but* still m1<->theta2
- it appears theta1 is about to capture m2, possibly run more time
  - [[*get computer account on exo][get computer account on exo]]
- only ran for weak precession so far, could precession totally
  disrupt capture?
  - [[*try stronger precession][try stronger precession]]
*** git log
commit db8b398f329f0e4456daf1bf2d121b60c57d60de
Author: jtlaune <jtlaune@gmail.com>
Date:   Wed Jan 5 18:14:34 2022 -0500

    Show behavior convergence from omeff>0 to 0
    
    Have shown that there is a change in behavior from
    0 to 1 that occurs x>0
* Possible inquiries                                               :noexport:
** can rings of dust interacting in MMRs affect ring dynamics?
- [[cite:&izidoro21_planet_rings_as_cause_solar]]
- can you model the evolution of planetessimal rings in late stage PPD
  as mass rings under the influence of a weak gas disk?

* research projects (?)                                            :noexport:
** TODO ask dong about a semi-analytic dust project [1/2]
[[*can rings of dust interacting in MMRs affect ring dynamics?][can rings of dust interacting in MMRs affect ring dynamics?]]
*** DONE Question: can two dust rings lock into MMR?
- answer: dong said: two dust rings cannot interact resonantly
*** TODO Question: can a massive planet capture a ring?
- can a massive planet "capture" an arc of the ring into a shepherded
  region that facilitates planetesimal mergers?
** semi-analytic celestial mechanics [0/2]
*** TODO apsidal alignment
*** TODO external perturber
** semi-analytic dust dynamics in accretion disks [0/2]
*** TODO ??
*** TODO ??
** hydrodynamic dusty accretion disk simulations [0/2]
*** TODO ??
*** TODO ??
* FINESST [0/1]                                                    :noexport:
** TODO new objective disk edge & migration
** maybe still include apsidal alignment section?
* paper sections                                                     :ignore:
** External precession in the comparable mass regime
 
** Results
*** External Test Particle with @@latex:$\omega_{\rm eff}$@@
*** figures                                                        :ignore:
#+BEGIN_SRC latex
  \begin{figure} \centering
  \includegraphics[width=0.45\textwidth]{{oldTpResults/total-gbehaviors-eq5.62e-02}.png}
  \caption{Here we have plotted the numerical average eccentricity of
  the test particle over the last 10\% of simulation time, while holding
  the disk forces constant to set $e_{\rm eq} = 0.056$. Each line
  corresponds to a different value of $e_p$, while holding disk and
  initial conditions constant. The dashed parts of the line indicate
  standard test particle behavior, which is dependent on the specific
  values of $e_p$ and $e_{\rm eq}$. The new behavior in the presence of
  $\omega_{\rm eff}$ is indicated by solid lines, where
  $\Delta\varpi\to\pi$.}
  \label{fig:omeffbehaviors}
  \end{figure}
#+END_SRC
#+BEGIN_SRC latex
        \begin{figure} \centering
  \includegraphics[width=0.45\textwidth]{{oldTpResults/regularbehavior}.png}
        \caption{Here we have plotted a typical outcome of test particle
  capture with weak external precession. This plot corresponds to the
  dashed segment of the pink line in Figure \ref{fig:omeffbehaviors}. As
  we can see, because $e_p>e_{\rm eq}$, apsides become aligned.}
        \end{figure}
#+END_SRC
#+BEGIN_SRC latex
      \begin{figure} \centering
      \includegraphics[width=0.45\textwidth]{{oldTpResults/newbehavior}.png}
      \caption{Here we have plotted a new phenomena of test particle capture
        with weak external precession. This plot corresponds to the solid segment
      of the pink line in Figure \ref{fig:omeffbehaviors}. As we can see,
    the apsides become anti-aligned. This is not previously a feature of
  TP capture with $\omega_{\rm eff}=0$.}
      \end{figure}
#+END_SRC


